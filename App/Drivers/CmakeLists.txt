set(APP_SOURCES
    ./Src/mt6816.cpp
    ./Src/tb67h450.cpp
    ./Src/button.cpp
    # ./Src/main.cpp
)

# 根据条件添加源文件
if(DRIVER_TEST IN_LIST TARGETS_TO_BUILD)
    message(STATUS "Building driver test")
    list(APPEND APP_SOURCES ./Src/test.cpp)
    add_executable(drivers ${APP_SOURCES})
else()
    # build as library
    add_library(drivers ${APP_SOURCES})
endif()

#包含 cmake 文件夹中的头文件
target_include_directories(drivers PUBLIC
    ${CMAKE_CURRENT_SOURCE_DIR}/Inc
)

# 链接 stm32cubemx 库
#target_link_directories(drivers PRIVATE ${CMAKE_SOURCE_DIR}/App/Peripherals)

target_link_libraries(drivers peripherals)